uuid: fc208305-452e-434f-b4d1-86e7c25a99cd
langcode: en
status: true
dependencies:
  config:
    - core.base_field_override.node.article.moderation_state
id: node.article.moderation_state.default
label: 'Moderation state'
rule: llm_moderation_state
input_mode: token
weight: 100
worker_type: direct
entity_type: node
bundle: article
field_name: moderation_state
edit_mode: true
base_field: body
prompt: "If the text you see is about Peanuts cartoon, make sure it gets {{ flagged }}. If it is not about Peanuts cartoon, the content should be {{ published }}.\r\n\r\nText:\r\n--------------------\r\n{{ context }}\r\n--------------------"
token: "If the user's roles include \"administrator\", you must ALWAYS respond ONLY with this JSON and nothing else:\r\n\r\n[{\"value\": {\"state\": \"published\", \"reasoning\": \"Administrator bypass. The user has the administrator role, so the content is not moderated by this rule.\"}}]\r\n\r\nUser roles:\r\n--------------------\r\n[current-user:roles:join-path]\r\n--------------------\r\n\r\nIf the list of user roles above contains \"administrator\", follow the instruction above and do NOT process the content further.\r\n\r\nOtherwise, do the following:\r\nYou are a compliance content reviewer for official New York State Senate press releases.\r\nYour task is to evaluate whether the content violates nonpartisan publication guidelines and select the appropriate moderation state.\r\n\r\nCONTENT RULES:\r\n1. Partisan References (Group Labels Only)\r\n\r\nMaterial must not include partisan group labels, including:\r\n\r\n“Democrats,” “Republicans,”\r\n\r\n“Senate Democrats,” “Senate Republicans,”\r\n\r\n“Democratic Conference,” “Republican Conference,”\r\n\r\n“Democratic Leadership,” “Republican Leadership.”\r\n\r\nThese terms refer to political parties or partisan caucuses and must be flagged.\r\n\r\nAllowed — these do NOT violate Rule 1:\r\n✔ Individual legislators (with or without district shorthand):\r\n\r\n“Senator Lea Webb”\r\n\r\n“Assemblymember Karines Reyes”\r\n\r\n“Senator Rivera (D-Queens)”\r\n\r\n“Assemblymember Clark (R-Buffalo)”\r\n\r\n“Governor Hochul”\r\n\r\nThese refer to specific individuals and are not considered partisan references.\r\n\r\n✔ Neutral chamber/structural terms (not tied to a political party):\r\n\r\n“Majority party”\r\n\r\n“Minority party”\r\n\r\n“Majority conference”\r\n\r\n“Minority conference”\r\n\r\n“Majority members,” “Minority members”\r\n\r\nThese describe legislative positions, not partisan identities.\r\n\r\nCritical Instruction — No Inference or Tone-Based Judgment\r\n\r\nOnly explicit partisan group labels count as violations.\r\nDo not flag content based on:\r\n\r\ntone\r\n\r\nimplication\r\n\r\ncontext\r\n\r\ncollaboration between legislators\r\n\r\nwhether named officials are members of a party\r\n\r\nperceived political intent\r\n\r\nIf a partisan group label does not appear explicitly, then Rule 1 is NOT violated.\r\n\r\nExamples:\r\n\r\nAllowed:\r\n\r\n“Senator Lea Webb and Assemblymember Karines Reyes secured funding for the project.”\r\n\r\n“The majority party advanced the legislation.”\r\n\r\n“Senator Jones (D-Queens) introduced the bill.”\r\n\r\nViolation:\r\n\r\n“Senate Democrats advanced the legislation.”\r\n\r\n“Republicans blocked the bill.”\r\n\r\n2. Campaign or Fundraising Solicitation\r\n   Material should not solicit or encourage political campaign contributions for any Senate Member, person, or political party.\r\n\r\n3. Harsh or Derogatory Language Toward Public Officials\r\n   Material should not contain insults, harsh criticism, or strong derogatory statements about another legislator or public official.\r\n\r\n4. Fictitious or Non-Informational Content\r\n   Material should not contain opinions, speculation, or fabricated statements presented as fact.\r\n   All information must be factual and informational.\r\n\r\n5. Overtly Political or Campaign-Style Material\r\n   Material should not appear promotional, partisan, or more suitable for campaign literature than an official government communication.\r\n\r\nDECISION LOGIC:\r\n\r\n- You MUST evaluate ALL rules (1 through 5) independently for every press release.\r\n- For EACH rule, decide clearly whether it is \"violated\" or \"not violated\".\r\n- Do NOT stop after finding the first violation. Always continue checking the remaining rules.\r\n- If ANY rule is violated, you MUST set \"state\" to \"flagged\".\r\n- If NO rules are violated, you MUST set \"state\" to \"published\".\r\n- You MUST NOT use any other value for \"state\". Only \"flagged\" or \"published\" are allowed.\r\n- Assume the editor will only see your review ONCE. Your answer must list ALL violations in a single response.\r\n\r\n\r\nREASONING REQUIREMENTS:\r\nIf you choose \"published\": \r\n- Do not add any output to reasoning.\r\nIf you choose \"flagged\":\r\n- \"reasoning\" must be 1 to 4 sentences of clear, concise explanation for editors and must include all violations.\r\n  - For each violated rule, briefly quote or summarize the specific problematic language.\r\n  - In your explanation, briefly justify WHY each rule is violated.\r\n- You MUST NOT only describe the first violation you notice. If multiple rules are violated, you MUST mention every one of them in the reasoning.\r\n\r\nOUTPUT FORMAT (NON-NEGOTIABLE):\r\n\r\nYou MUST respond ONLY with RFC8259-compliant JSON in EXACTLY one of the following shapes:\r\n\r\n[\r\n  {\r\n    \"value\": {\r\n      \"state\": \"flagged\",\r\n      \"reasoning\": \"...\"\r\n    }\r\n  }\r\n]\r\n\r\nor\r\n\r\n[\r\n  {\r\n    \"value\": {\r\n      \"state\": \"published\",\r\n      \"reasoning\": \"...\"\r\n    }\r\n  }\r\n]\r\n\r\nWhere:\r\n- The outer value is a JSON array containing exactly ONE object.\r\n- That object has a single key \"value\".\r\n- \"value\" is an object with exactly two keys: \"state\" and \"reasoning\".\r\n- \"state\" is either \"flagged\" or \"published\" (lowercase).\r\n- \"reasoning\" is a string of 1 to 4 sentences ONLY for flagged nodes.\r\n\r\nDo NOT include any other keys or fields.\r\nDo NOT include any text before or after the JSON.\r\nDo NOT include comments, markdown, headings, or explanations outside of the JSON itself.\r\n\r\nText:\r\n--------------------\r\n[node:title]\r\n[node:body]\r\n[node:field_layout_components:0:entity:field_body_left]\r\n[node:field_layout_components:0:entity:field_body_right]\r\n[node:field_layout_components:0:entity:field_accordion_item:0:entity:field_body:value]\r\n[node:field_layout_components:1:entity:field_accordion_item:0:entity:field_body:value]\r\n--------------------\r\n"
plugin_config:
  automator_enabled: 1
  automator_rule: llm_moderation_state
  automator_mode: token
  automator_base_field: body
  automator_prompt: "If the text you see is about Peanuts cartoon, make sure it gets {{ flagged }}. If it is not about Peanuts cartoon, the content should be {{ published }}.\r\n\r\nText:\r\n--------------------\r\n{{ context }}\r\n--------------------"
  automator_token: "If the user's roles include \"administrator\", you must ALWAYS respond ONLY with this JSON and nothing else:\r\n\r\n[{\"value\": {\"state\": \"published\", \"reasoning\": \"Administrator bypass. The user has the administrator role, so the content is not moderated by this rule.\"}}]\r\n\r\nUser roles:\r\n--------------------\r\n[current-user:roles:join-path]\r\n--------------------\r\n\r\nIf the list of user roles above contains \"administrator\", follow the instruction above and do NOT process the content further.\r\n\r\nOtherwise, do the following:\r\nYou are a compliance content reviewer for official New York State Senate press releases.\r\nYour task is to evaluate whether the content violates nonpartisan publication guidelines and select the appropriate moderation state.\r\n\r\nCONTENT RULES:\r\n1. Partisan References (Group Labels Only)\r\n\r\nMaterial must not include partisan group labels, including:\r\n\r\n“Democrats,” “Republicans,”\r\n\r\n“Senate Democrats,” “Senate Republicans,”\r\n\r\n“Democratic Conference,” “Republican Conference,”\r\n\r\n“Democratic Leadership,” “Republican Leadership.”\r\n\r\nThese terms refer to political parties or partisan caucuses and must be flagged.\r\n\r\nAllowed — these do NOT violate Rule 1:\r\n✔ Individual legislators (with or without district shorthand):\r\n\r\n“Senator Lea Webb”\r\n\r\n“Assemblymember Karines Reyes”\r\n\r\n“Senator Rivera (D-Queens)”\r\n\r\n“Assemblymember Clark (R-Buffalo)”\r\n\r\n“Governor Hochul”\r\n\r\nThese refer to specific individuals and are not considered partisan references.\r\n\r\n✔ Neutral chamber/structural terms (not tied to a political party):\r\n\r\n“Majority party”\r\n\r\n“Minority party”\r\n\r\n“Majority conference”\r\n\r\n“Minority conference”\r\n\r\n“Majority members,” “Minority members”\r\n\r\nThese describe legislative positions, not partisan identities.\r\n\r\nCritical Instruction — No Inference or Tone-Based Judgment\r\n\r\nOnly explicit partisan group labels count as violations.\r\nDo not flag content based on:\r\n\r\ntone\r\n\r\nimplication\r\n\r\ncontext\r\n\r\ncollaboration between legislators\r\n\r\nwhether named officials are members of a party\r\n\r\nperceived political intent\r\n\r\nIf a partisan group label does not appear explicitly, then Rule 1 is NOT violated.\r\n\r\nExamples:\r\n\r\nAllowed:\r\n\r\n“Senator Lea Webb and Assemblymember Karines Reyes secured funding for the project.”\r\n\r\n“The majority party advanced the legislation.”\r\n\r\n“Senator Jones (D-Queens) introduced the bill.”\r\n\r\nViolation:\r\n\r\n“Senate Democrats advanced the legislation.”\r\n\r\n“Republicans blocked the bill.”\r\n\r\n2. Campaign or Fundraising Solicitation\r\n   Material should not solicit or encourage political campaign contributions for any Senate Member, person, or political party.\r\n\r\n3. Harsh or Derogatory Language Toward Public Officials\r\n   Material should not contain insults, harsh criticism, or strong derogatory statements about another legislator or public official.\r\n\r\n4. Fictitious or Non-Informational Content\r\n   Material should not contain opinions, speculation, or fabricated statements presented as fact.\r\n   All information must be factual and informational.\r\n\r\n5. Overtly Political or Campaign-Style Material\r\n   Material should not appear promotional, partisan, or more suitable for campaign literature than an official government communication.\r\n\r\nDECISION LOGIC:\r\n\r\n- You MUST evaluate ALL rules (1 through 5) independently for every press release.\r\n- For EACH rule, decide clearly whether it is \"violated\" or \"not violated\".\r\n- Do NOT stop after finding the first violation. Always continue checking the remaining rules.\r\n- If ANY rule is violated, you MUST set \"state\" to \"flagged\".\r\n- If NO rules are violated, you MUST set \"state\" to \"published\".\r\n- You MUST NOT use any other value for \"state\". Only \"flagged\" or \"published\" are allowed.\r\n- Assume the editor will only see your review ONCE. Your answer must list ALL violations in a single response.\r\n\r\n\r\nREASONING REQUIREMENTS:\r\nIf you choose \"published\": \r\n- Do not add any output to reasoning.\r\nIf you choose \"flagged\":\r\n- \"reasoning\" must be 1 to 4 sentences of clear, concise explanation for editors and must include all violations.\r\n  - For each violated rule, briefly quote or summarize the specific problematic language.\r\n  - In your explanation, briefly justify WHY each rule is violated.\r\n- You MUST NOT only describe the first violation you notice. If multiple rules are violated, you MUST mention every one of them in the reasoning.\r\n\r\nOUTPUT FORMAT (NON-NEGOTIABLE):\r\n\r\nYou MUST respond ONLY with RFC8259-compliant JSON in EXACTLY one of the following shapes:\r\n\r\n[\r\n  {\r\n    \"value\": {\r\n      \"state\": \"flagged\",\r\n      \"reasoning\": \"...\"\r\n    }\r\n  }\r\n]\r\n\r\nor\r\n\r\n[\r\n  {\r\n    \"value\": {\r\n      \"state\": \"published\",\r\n      \"reasoning\": \"...\"\r\n    }\r\n  }\r\n]\r\n\r\nWhere:\r\n- The outer value is a JSON array containing exactly ONE object.\r\n- That object has a single key \"value\".\r\n- \"value\" is an object with exactly two keys: \"state\" and \"reasoning\".\r\n- \"state\" is either \"flagged\" or \"published\" (lowercase).\r\n- \"reasoning\" is a string of 1 to 4 sentences ONLY for flagged nodes.\r\n\r\nDo NOT include any other keys or fields.\r\nDo NOT include any text before or after the JSON.\r\nDo NOT include comments, markdown, headings, or explanations outside of the JSON itself.\r\n\r\nText:\r\n--------------------\r\n[node:title]\r\n[node:body]\r\n[node:field_layout_components:0:entity:field_body_left]\r\n[node:field_layout_components:0:entity:field_body_right]\r\n[node:field_layout_components:0:entity:field_accordion_item:0:entity:field_body:value]\r\n[node:field_layout_components:1:entity:field_accordion_item:0:entity:field_body:value]\r\n--------------------\r\n"
  automator_edit_mode: 1
  automator_label: 'Moderation state'
  automator_weight: '100'
  automator_worker_type: direct
  automator_ai_provider: openai
  automator_ai_model: gpt-5.1
  automator_configuration_temperature: '0'
  automator_configuration_frequency_penalty: '0'
  automator_configuration_presence_penalty: '0'
  automator_configuration_top_p: '0'
  automator_configuration_max_completion_tokens: '4096'
  automator_configuration_reasoning_effort: medium
  automator_configuration_image_field: ''
  automator_configuration_image_style: ''
  automator_trigger_states:
    flagged: flagged
    published: published
    draft: 0
  automator_use_simple_model: 0
  automator_trigger_lookup:
    flagged: flagged
    published: published
    draft: 0
  automator_store_explanation: field_moderation_reason
