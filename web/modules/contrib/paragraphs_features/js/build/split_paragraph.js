!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.split_paragraph=t())}(self,(function(){return function(){var e={"ckeditor5/src/core.js":function(e,t,r){e.exports=r("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/ui.js":function(e,t,r){e.exports=r("dll-reference CKEditor5.dll")("./src/ui.js")},"dll-reference CKEditor5.dll":function(e){"use strict";e.exports=CKEditor5.dll}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var o={};return function(){"use strict";r.d(o,{default:function(){return s}});var e=r("ckeditor5/src/core.js"),t=r("ckeditor5/src/ui.js");class a extends e.Command{execute(){const{model:e,sourceElement:t}=this.editor,r=Drupal.t("[Splitting in progress... âŒ›]"),o=this.editor.getData();e.change((t=>{t.insertText(r,e.document.selection.getFirstPosition())}));const i=(new DOMParser).parseFromString(this.editor.getData(),"text/html").body,[s,n,d]=a.splitNode(i,r);if(!d||!s||!n)return void this.editor.setData(o);const l=t.closest(".paragraphs-subform").closest("tr.draggable"),p=l.querySelector("[data-paragraphs-split-text-type]").dataset.paragraphsSplitTextType,c=[...l.parentNode.children].filter((e=>e.querySelector(".paragraphs-actions"))).indexOf(l)+1,u=[...l.parentNode.children].indexOf(l);window._splitParagraph={data:{first:s.outerHTML,second:n.outerHTML},selector:t.dataset.drupalSelector,originalRowIndex:u};const h=t.closest(".field--widget-paragraphs").querySelector("input.paragraph-type-add-delta.modal");h.value=c;const g=h.getAttribute("data-drupal-selector").substr(5).replace(/-add-more-add-more-delta$/,"-"+p+"-add-more").replace(/_/g,"-");t.closest(".field--widget-paragraphs").querySelector('[data-drupal-selector^="'+g+'"]').dispatchEvent(new Event("mousedown"))}refresh(){this.isEnabled=!!this.editor.sourceElement.closest(".field--widget-paragraphs")?.querySelector("input.paragraph-type-add-delta.modal")}static splitNode(e,t){const r=e=>{if(e.nodeType===Node.TEXT_NODE){const r=e.data.indexOf(t);if(r>=0){const o=e.data.substring(0,r),a=e.data.substring(r+t.length);return[o?document.createTextNode(o):null,a?document.createTextNode(a):null,!0]}return[e,null,!1]}const o=[],a=[];let i=!1;if(e.childNodes.forEach((e=>{if(i)a.push(e);else{const[t,s,n]=r(e);i=n,t&&o.push(t),s&&a.push(s)}})),!i)return[e,null,!1];const s=e.cloneNode(),n=e.cloneNode();return o.forEach((e=>{s.appendChild(e)})),a.forEach((e=>{n.appendChild(e)})),[s.childNodes.length>0?s:null,n.childNodes.length>0?n:null,i]};return r(e)}}class i extends e.Plugin{init(){this.editor.ui.componentFactory.add("splitParagraph",(e=>{const r=this.editor.commands.get("splitParagraph"),o=new t.ButtonView(e);return o.set({label:this.editor.t("Split Paragraph"),icon:'<?xml version="1.0" encoding="utf-8"?>\r\n\r\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\r\n\x3c!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools --\x3e\r\n<svg width="800px" height="800px" viewBox="0 0 17 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\r\n\t<path d="M10.646 13.146l0.707 0.707-2.853 2.854-2.854-2.854 0.707-0.707 1.647 1.647v-3.772h1v3.772l1.646-1.647zM8 2.207v3.772h1v-3.772l1.646 1.646 0.707-0.707-2.853-2.853-2.854 2.853 0.707 0.707 1.647-1.646zM0 8v1h17v-1h-17z"/>\r\n</svg>',tooltip:!0}),o.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(o,"execute",(()=>this.editor.execute("splitParagraph"))),o})),this.editor.commands.add("splitParagraph",new a(this.editor))}afterInit(){if(window._splitParagraph){if("string"==typeof window._splitParagraph.data.second){const e=this.editor.sourceElement.closest("tr.draggable");let t=e?.previousElementSibling;for(;t&&!t.matches("tr.draggable");)t=t.previousElementSibling;[...e.parentElement.children].indexOf(t)===window._splitParagraph.originalRowIndex&&this.editor.sourceElement.dataset.drupalSelector.match(window._splitParagraph.selector.replace(/-[0-9]+-?/,"-[0-9]+-"))&&setTimeout((()=>{this.editor.setData(window._splitParagraph.data.second),window._splitParagraph.data.second=null}),0)}"string"==typeof window._splitParagraph.data.first&&this.editor.sourceElement.dataset.drupalSelector===window._splitParagraph.selector&&setTimeout((()=>{this.editor.setData(window._splitParagraph.data.first),window._splitParagraph.data.first=null}),0)}}}var s={SplitParagraph:i}}(),o=o.default}()}));